```uml
@startuml

opt ログイン中

opt 購入履歴・閲覧履歴
ユーザー -> Webサーバー : 購入履歴・閲覧履歴をクリック
Webサーバー -> DBサーバー :ユーザー情報
DBサーバー -> DBサーバー : ユーザー照会・履歴取得
DBサーバー -> Webサーバー : 購入履歴・閲覧履歴
Webサーバー -> ユーザー : 購入履歴・閲覧履歴
end

opt 会員情報編集
ユーザー -> Webサーバー : 変更する情報を入力
Webサーバー -> DBサーバー :情報送信
DBサーバー -> DBサーバー : 変更処理
DBサーバー -> Webサーバー : 編集結果
Webサーバー -> ユーザー : 編集結果
end
end

ユーザー -> Webサーバー : 検索(商品名)
Webサーバー -> DBサーバー : 検索処理(商品名)
DBサーバー -> DBサーバー : 検索処理
DBサーバー -> Webサーバー : 検索結果
Webサーバー -> ユーザー : 検索結果

opt 商品クリック(商品詳細表示)
ユーザー -> Webサーバー : 商品クリック
Webサーバー -> DBサーバー : 商品照会
DBサーバー -> Webサーバー : 照会結果
Webサーバー -> ユーザー : 詳細情報表示

opt お気に入り商品に追加
ユーザー -> Webサーバー : お気に入りに追加をクリック
Webサーバー -> DBサーバー : 商品情報
DBサーバー -> DBサーバー : 商品照会・お気に入りへの追加
DBサーバー -> Webサーバー : 照会結果
Webサーバー -> ユーザー : 追加メッセージの表示
end

alt 在庫あり
opt カートに商品を追加
ユーザー -> Webサーバー : カートに追加
Webサーバー -> DBサーバー : 商品照会
DBサーバー -> DBサーバー : カートに追加された分の商品数を減らす
DBサーバー -> Webサーバー : 処理結果
Webサーバー -> ユーザー : 処理結果
end

else 在庫なし
ユーザー -> Webサーバー : カートに追加
Webサーバー -> DBサーバー : 商品照会
DBサーバー -> Webサーバー : 照会結果
Webサーバー -> ユーザー : 在庫結果
end

@enduml
```
